<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <link rel="manifest" href="manifest.json">
  <meta charset="UTF-8" />
  <title>Simulador Boitel Santa Inês</title>
  <style>
    /* Coloque aqui o CSS depois que pedir */
* {
  box-sizing: border-box;
}

.volume-resumo {
  display: flex;
  flex-direction: column;
  gap: 6px;
  font-size: 1rem;
  margin-top: 15px;
}

.volume-resumo div {
  display: flex;
  justify-content: space-between;
  white-space: nowrap;
  padding: 6px 12px;
  background-color: #f0f0f0;
  border-left: 4px solid #2e5c2e;
  border-radius: 4px;
}

body {
  font-family: Arial, sans-serif;
  background-color: #f5f5f5;
  color: #333;
  padding: 20px;
  max-width: 900px;
  margin: auto;
}

h1, h2 {
  text-align: center;
  color: #2e5c2e;
  margin-bottom: 20px;
}

form#formulario {
  background: #fff;
  padding: 25px 30px;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.12);
}

.form-row {
  display: flex;
  flex-wrap: wrap;
  gap: 20px;
  margin-bottom: 20px;
}

.input-group {
  flex: 1 1 30%;
  min-width: 180px;
  display: flex;
  flex-direction: column;
}

.input-group label {
  font-weight: 600;
  margin-bottom: 6px;
}

.input-group input[type="number"] {
  padding: 8px 10px;
  font-size: 1rem;
  border: 1px solid #ccc;
  border-radius: 5px;
  transition: border-color 0.2s ease;
}

.input-group input[type="number"]:focus {
  border-color: #2e5c2e;
  outline: none;
}

.unit {
  font-size: 0.85rem;
  color: #666;
  margin-top: 4px;
}

.radio-inline {
  display: flex;
  align-items: center;
  gap: 20px;
  flex-wrap: wrap;
  padding-top: 8px;
}

.radio-inline span {
  font-weight: 600;
  min-width: 90px;
}

.radio-inline label {
  display: flex;
  align-items: center;
  gap: 6px;
  font-weight: normal;
  cursor: pointer;
  user-select: none;
}

hr {
  margin: 35px 0;
  border: none;
  border-top: 2px solid #ccc;
}

.custos-insumos {
  display: flex;
  flex-wrap: wrap;
  gap: 25px;
  justify-content: space-between;
  margin-bottom: 20px;
}

.custo-insumo-group {
  background: #fafafa;
  border-radius: 8px;
  padding: 15px 20px;
  flex: 1 1 230px;
  min-width: 230px;
  box-shadow: 0 1px 5px rgba(0,0,0,0.05);
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.custo-insumo-nome {
  font-weight: 700;
  font-size: 1.1rem;
  color: #1a4d1a;
  margin-bottom: 8px;
}

.input-com-label {
  display: flex;
  flex-direction: column;
}

.input-com-label input[type="number"] {
  padding: 7px 10px;
  font-size: 1rem;
  border: 1px solid #bbb;
  border-radius: 5px;
  transition: border-color 0.2s ease;
}

.input-com-label input[type="number"]:focus {
  border-color: #2e5c2e;
  outline: none;
}

label[for="usarPercentuais"] {
  display: flex;
  align-items: center;
  gap: 8px;
  font-weight: 600;
  margin-bottom: 15px;
  cursor: pointer;
  user-select: none;
}

#camposPercentuais {
  display: flex;
  gap: 20px;
  flex-wrap: wrap;
  margin-bottom: 25px;
}

#camposPercentuais label {
  flex: 1 1 120px;
  font-weight: 600;
  display: flex;
  flex-direction: column;
  font-size: 0.95rem;
}

#camposPercentuais input[type="number"] {
  margin-top: 6px;
  padding: 6px 10px;
  border-radius: 5px;
  border: 1px solid #bbb;
  font-size: 1rem;
  transition: border-color 0.2s ease;
}

#camposPercentuais input[type="number"]:focus {
  border-color: #2e5c2e;
  outline: none;
}

button#calcular, button#limpar {
  display: inline-block;
  margin: 0 10px 20px 10px;
  background-color: #2e5c2e;
  color: white;
  border: none;
  padding: 12px 28px;
  font-size: 1.1rem;
  border-radius: 6px;
  cursor: pointer;
  transition: background-color 0.3s ease;
}

button#calcular:hover, button#limpar:hover {
  background-color: #1e3f1e;
}

#resultados {
  margin-top: 40px;
  padding: 20px 30px;
  background: #fff;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.12);
  display: none;
}

.resultados-container {
  display: grid;
  grid-template-columns: repeat(auto-fit,minmax(260px,1fr));
  gap: 18px;
}

.resultados-container div {
  background: #f7f7f7;
  border-left: 5px solid #2e5c2e;
  padding: 14px 18px;
  font-weight: 700;
  font-size: 1rem;
  color: #264d26;
  border-radius: 4px;
  box-shadow: 0 1px 3px rgba(0,0,0,0.05);
}

/* Responsividade para telas pequenas */
@media (max-width: 600px) {
  .form-row {
    flex-direction: column;
  }

  .input-group {
    flex: 1 1 100%;
  }

  .custos-insumos {
    flex-direction: column;
  }

  .custo-insumo-group {
    min-width: 100%;
  }

  #camposPercentuais {
    flex-direction: column;
  }

  #camposPercentuais label {
    flex: 1 1 100%;
  }

  button#calcular, button#limpar {
    width: 100%;
    margin: 10px 0;
  }
}

  </style>
</head>
<body>

  <h1>Simulador Boitel Santa Inês</h1>

  <form id="formulario">

    <h2>Informações do Lote</h2>

    <div class="form-row">
      <div class="input-group">
        <label for="lote">Lote</label>
        <input type="number" id="lote" required placeholder="Quantidade" min="1" />
        <span class="unit">Animais</span>
      </div>
      <div class="input-group">
        <label for="pesoInicial">Peso Inicial (Média)</label>
        <input type="number" id="pesoInicial" required step="0.1" min="0" />
        <span class="unit">Kg</span>
      </div>
      <div class="input-group">
        <label for="rendimento">Rendimento</label>
        <input type="number" id="rendimento" required step="0.1" min="0" max="100" />
        <span class="unit">%</span>
      </div>
    </div>

    <div class="form-row">
      <div class="input-group">
        <label for="consumo">Consumo</label>
        <input type="number" id="consumo" required step="0.01" min="0" max="100" />
        <span class="unit">%</span>
      </div>
      <div class="input-group">
        <label for="gmd">GMD</label>
        <input type="number" id="gmd" required step="0.01" min="0" />
        <span class="unit">kg/Animal/Dia</span>
      </div>
      <div class="input-group">
        <label for="diasConfinamento">Confinamento Pleno</label>
        <input type="number" id="diasConfinamento" required min="1" />
        <span class="unit">dias</span>
      </div>
    </div>

    <div class="form-row">
      <div class="input-group">
        <label for="boitel">Boitel (Serviços)</label>
        <input type="number" id="boitel" step="0.01" required min="0" />
        <span class="unit">R$/animal/dia</span>
      </div>
      <div class="input-group">
        <label for="precoCompra">Preço de Compra</label>
        <input type="number" id="precoCompra" step="0.01" required min="0" />
        <span class="unit">R$/@ ou R$/animal</span>
      </div>
      <div class="input-group radio-inline">
        <span>Tipo Compra:</span>
        <label><input type="radio" name="tipoCompra" value="arroba" checked /> R$/@</label>
        <label><input type="radio" name="tipoCompra" value="animal" /> R$/animal</label>
      </div>
    </div>

    <div class="form-row">
      <div class="input-group">
        <label for="precoVenda">Preço de Venda</label>
        <input type="number" id="precoVenda" step="0.01" required min="0" />
        <span class="unit">R$/@</span>
      </div>
    </div>

    <hr />

    <h2>Custos de Insumos</h2>

    <div class="custos-insumos">

      <div class="custo-insumo-group">
        <div class="custo-insumo-nome">Milho</div>
        <div class="input-com-label">
          <input type="number" id="precoMilhoSaco" step="0.01" value="75.00" required min="0" />
          <span class="unit">R$/Saco (60kg)</span>
        </div>
        <div class="input-com-label">
          <input type="number" id="precoMilhoKg" step="0.01" value="1.25" required min="0" />
          <span class="unit">R$/kg</span>
        </div>
      </div>

      <div class="custo-insumo-group">
        <div class="custo-insumo-nome">Top Grão30</div>
        <div class="input-com-label">
          <input type="number" id="precoTopGraoSaco" step="0.01" value="120.78" required min="0" />
          <span class="unit">R$/Saco (40kg)</span>
        </div>
        <div class="input-com-label">
          <input type="number" id="precoTopGraoKg" step="0.01" value="3.02" required min="0" />
          <span class="unit">R$/kg</span>
        </div>
      </div>

      <div class="custo-insumo-group">
        <div class="custo-insumo-nome">Forragem</div>
        <div class="input-com-label">
          <input type="number" id="precoForragemTon" step="0.01" value="200.00" required min="0" />
          <span class="unit">R$/Ton (1000kg)</span>
        </div>
        <div class="input-com-label">
          <input type="number" id="precoForragemKg" step="0.01" value="0.20" required min="0" />
          <span class="unit">R$/kg</span>
        </div>
      </div>

      <div class="custo-insumo-group">
        <div class="custo-insumo-nome">Sal Mineral</div>
        <div class="input-com-label">
          <input type="number" id="precoSalSaco" step="0.01" value="108.00" required min="0" />
          <span class="unit">R$/Saco (30kg)</span>
        </div>
        <div class="input-com-label">
          <input type="number" id="precoSalKg" step="0.01" value="3.60" required min="0" />
          <span class="unit">R$/kg</span>
        </div>
      </div>

    </div>

    <label for="usarPercentuais" style="display: block; margin-top: 15px; cursor: pointer;">
      <input type="checkbox" id="usarPercentuais" />
      Usar porcentagens customizadas
    </label>

    <div id="camposPercentuais" style="display:none; margin-top: 10px;">
      <label>Milho (%) <input type="number" id="percMilho" step="0.1" min="0" max="100" value="20" /></label>
      <label>Top Grão (%) <input type="number" id="percTopGrao" step="0.1" min="0" max="100" value="7" /></label>
      <label>Forragem (%) <input type="number" id="percForragem" step="0.1" min="0" max="100" value="70" /></label>
      <label>Sal Mineral (%) <input type="number" id="percSal" step="0.1" min="0" max="100" value="3" /></label>
    </div>

    <button type="submit" id="calcular">Calcular Resultados</button>
    <button type="button" id="limpar">Limpar Campos</button>

  </form>

  <section id="resultados" style="display:none;">
    <div class="resultados-container" id="resultadoValores">
      <!-- Resultados aparecerão aqui -->
    </div>

    <hr />
    <h3>Resumo de Volumes (kg)</h3>
    <div class="volume-resumo">
      <div><strong>Milho Total:</strong> <span id="volumeMilho">-</span></div>
      <div><strong>Top Grão Total:</strong> <span id="volumeTopGrao">-</span></div>
      <div><strong>Capim Total:</strong> <span id="volumeCapim">-</span></div>
    </div>
  </section>

<script>
document.addEventListener('DOMContentLoaded', function () {
  const form = document.getElementById('formulario');
  const resultadosDiv = document.getElementById('resultados');
  const btnLimpar = document.getElementById('limpar');
  const usarPercentuaisCheckbox = document.getElementById('usarPercentuais');
  const camposPercentuaisDiv = document.getElementById('camposPercentuais');

  // Percentuais fixos padrão (em decimal)
  const percentuaisFixos = {
    milho: 0.20,
    topgrao: 0.07,
    forragem: 0.70,
    sal: 0.03,
  };

  // Mostrar/esconder campos de percentuais customizados
  usarPercentuaisCheckbox.addEventListener('change', () => {
    camposPercentuaisDiv.style.display = usarPercentuaisCheckbox.checked ? 'flex' : 'none';
  });

  // Função para calcular R$/kg automaticamente e permitir edição manual
  function configurarCampoPrecoKg(idSaco, idKg, pesoPorUnidade) {
    const campoSaco = document.getElementById(idSaco);
    const campoKg = document.getElementById(idKg);
    let editadoManualmente = false;

    campoKg.addEventListener('input', () => {
      editadoManualmente = true;
    });

    campoSaco.addEventListener('input', () => {
      if (!editadoManualmente) {
        const valorSaco = parseFloat(campoSaco.value);
        if (!isNaN(valorSaco) && pesoPorUnidade > 0) {
          campoKg.value = (valorSaco / pesoPorUnidade).toFixed(2);
        }
      }
    });

    campoKg.addEventListener('change', () => {
      if (campoKg.value.trim() === '') {
        editadoManualmente = false;
        const valorSaco = parseFloat(campoSaco.value);
        if (!isNaN(valorSaco) && pesoPorUnidade > 0) {
          campoKg.value = (valorSaco / pesoPorUnidade).toFixed(2);
        }
      }
    });

    // Inicializa valor calculado ao carregar
    if (campoSaco.value && !editadoManualmente) {
      campoKg.value = (parseFloat(campoSaco.value) / pesoPorUnidade).toFixed(2);
    }
  }

  // Inicializar campos R$/kg
  function inicializarPrecosKgAutomaticos() {
    configurarCampoPrecoKg('precoMilhoSaco', 'precoMilhoKg', 60);
    configurarCampoPrecoKg('precoTopGraoSaco', 'precoTopGraoKg', 40);
    configurarCampoPrecoKg('precoForragemTon', 'precoForragemKg', 1000);
    configurarCampoPrecoKg('precoSalSaco', 'precoSalKg', 30);
  }

  inicializarPrecosKgAutomaticos();

  // Botão limpar
  btnLimpar.addEventListener('click', () => {
    form.reset();
    resultadosDiv.innerHTML = '';
    resultadosDiv.style.display = 'none';
    inicializarPrecosKgAutomaticos();
    camposPercentuaisDiv.style.display = 'none';
  });

  // Função para pegar valor float de input e substituir vírgula por ponto
  const getFloat = (id) => parseFloat(document.getElementById(id).value.replace(',', '.')) || 0;

  // Função para formatar valor em real brasileiro com vírgula e ponto corretos
  function formatarReal(valor) {
    return valor.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
  }

  form.addEventListener('submit', function (e) {
    e.preventDefault();

    const lote = getFloat('lote');
    const pesoInicial = getFloat('pesoInicial');
    const rendimento = getFloat('rendimento') / 100;
    const consumo = getFloat('consumo') / 100;
    const gmd = getFloat('gmd');
    const diasConfinamento = getFloat('diasConfinamento');
    const boitel = getFloat('boitel');
    const precoVenda = getFloat('precoVenda');

    const precoCompraTipo = document.querySelector('input[name="tipoCompra"]:checked').value;
    const precoCompra = getFloat('precoCompra');

    const milhoKg = getFloat('precoMilhoKg');
    const topGraoKg = getFloat('precoTopGraoKg');
    const forragemKg = getFloat('precoForragemKg');
    const salKg = getFloat('precoSalKg');

    // Escolher percentuais fixos ou customizados
    let percMilho, percTop, percForragem, percSal;
    if (usarPercentuaisCheckbox.checked) {
      percMilho = getFloat('percMilho') / 100;
      percTop = getFloat('percTopGrao') / 100;
      percForragem = getFloat('percForragem') / 100;
      percSal = getFloat('percSal') / 100;
    } else {
      percMilho = percentuaisFixos.milho;
      percTop = percentuaisFixos.topgrao;
      percForragem = percentuaisFixos.forragem;
      percSal = percentuaisFixos.sal;
    }

    const diasAdap = 14;
    const diasEngorda = diasConfinamento - diasAdap;

    const pesoFinal = pesoInicial + (gmd * diasConfinamento);
    const pesoCarcaca = pesoFinal * rendimento;
    const pesoCarcacaLote = pesoCarcaca * lote;
    const pesoCarcacaArroba = pesoCarcacaLote / 15;

    const consumoAdapTotalKg = lote * pesoInicial * consumo * diasAdap;
    const consumoEngordaTotalKg = lote * pesoFinal * consumo * diasEngorda;

    const custoAdap = consumoAdapTotalKg * (
      percMilho * milhoKg +
      percTop * topGraoKg +
      percForragem * forragemKg +
      percSal * salKg
    );

    const custoEngorda = consumoEngordaTotalKg * (
      percMilho * milhoKg +
      percTop * topGraoKg +
      percForragem * forragemKg +
      percSal * salKg
    );

    const custoBoitel = lote * boitel * diasConfinamento;

    const custoTotal = custoAdap + custoEngorda + custoBoitel;

    const valorEntrada = precoCompraTipo === 'arroba'
      ? ((pesoInicial / 30) * precoCompra) * lote
      : precoCompra * lote;

    const valorSaida = pesoCarcacaArroba * precoVenda;
    const lucroLiquido = valorSaida - valorEntrada - custoTotal;

    // Cálculo do volume total de ração consumida (Adaptação + Engorda)
    const consumoTotalKg = consumoAdapTotalKg + consumoEngordaTotalKg;

    // Volume total dos ingredientes baseado nos percentuais usados
    const volumeMilho = consumoTotalKg * percMilho;
    const volumeTopGrao = consumoTotalKg * percTop;
    const volumeCapim = consumoTotalKg * percForragem;

    // Atualiza no HTML (spans com esses ids)
    document.getElementById('volumeMilho').textContent = volumeMilho.toFixed(2) + ' kg';
    document.getElementById('volumeTopGrao').textContent = volumeTopGrao.toFixed(2) + ' kg';
    document.getElementById('volumeCapim').textContent = volumeCapim.toFixed(2) + ' kg';

    resultadosDiv.style.display = 'block';
    resultadosDiv.innerHTML = `
      <div class="resultados-container">
        <div><strong>Adaptação (14 dias):</strong> ${formatarReal(custoAdap)}</div>
        <div><strong>Engorda (Puro Grão):</strong> ${formatarReal(custoEngorda)}</div>
        <div><strong>Boitel:</strong> ${formatarReal(custoBoitel)}</div>
        <div><strong>Total de Custos:</strong> ${formatarReal(custoTotal)}</div>
        <div><strong>Peso Final Esperado (Média):</strong> ${pesoFinal.toFixed(2)} kg/animal</div>
        <div><strong>Peso Carcaça Total:</strong> ${pesoCarcacaLote.toFixed(2)} kg</div>
        <div><strong>Peso Carcaça (@):</strong> ${pesoCarcacaArroba.toFixed(2)} @</div>
        <div><strong>Valor Entrada:</strong> ${formatarReal(valorEntrada)}</div>
        <div><strong>Valor Saída:</strong> ${formatarReal(valorSaida)}</div>
        <div><strong>Lucro Líquido:</strong> ${formatarReal(lucroLiquido)}</div>
      </div>
      <hr>
      <h3>Resumo de Volumes (kg)</h3>
      <div class="volume-resumo">
        <div><strong>Milho Total:</strong> ${volumeMilho.toFixed(2)} kg</div>
        <div><strong>Top Grão Total:</strong> ${volumeTopGrao.toFixed(2)} kg</div>
        <div><strong>Capim Total:</strong> ${volumeCapim.toFixed(2)} kg</div>
      </div>
    `;
  });
});
</script>

<script>
  if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('serviceWorker.js')
    .then(() => console.log('Service Worker registrado com sucesso!'))
    .catch(err => console.log('Erro ao registrar Service Worker', err));
}
</script>

</body>
</html>
